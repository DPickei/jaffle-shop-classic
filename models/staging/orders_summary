-- models/orders_summary.sql
WITH base AS (
    SELECT
        customer_id,
        COUNT(order_id) AS total_orders,
        SUM(amount) AS total_amount,
        AVG(amount) AS avg_order_value
    FROM {{ ref('stg_orders') }}
    GROUP BY customer_id
)

SELECT
    customer_id,
    total_orders,
    total_amount,
    avg_order_value
FROM base
